<!DOCTYPE html>
<!-- 
    ============================================================================
    é…ç½®è¯´æ˜ï¼š
    âœ… DeepSeek APIå¯†é’¥å·²é…ç½®ï¼ˆç¬¬424è¡Œï¼‰
    
    1. APIå¯†é’¥ï¼šDEEPSEEK_API_KEY å·²å¡«å…¥æ‚¨çš„å¯†é’¥
       å½“å‰å€¼ï¼šsk-54080103e6954b16b42817af05a9088b
    
    2. APIåœ°å€ï¼šDEEPSEEK_API_URLï¼ˆçº¦ç¬¬425è¡Œï¼‰
       å½“å‰å€¼ï¼šhttps://api.deepseek.com/v1/chat/completions
    
    3. æ¨¡å‹åç§°ï¼šDEEPSEEK_MODELï¼ˆçº¦ç¬¬426è¡Œï¼‰
       å½“å‰å€¼ï¼šdeepseek-chat
    
    4. çºªå¿µæ—¥ï¼šå¯ä»¥åœ¨JavaScriptéƒ¨åˆ†ï¼ˆçº¦ç¬¬430è¡Œï¼‰çš„ anniversaries æ•°ç»„ä¸­æ·»åŠ çºªå¿µæ—¥
    ============================================================================
-->
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>åœ£è¯åº†å…¸</title>
    <style>
        /* åŸºç¡€æ ·å¼é‡ç½® */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        /* é¡µé¢æ•´ä½“æ ·å¼ */
        .christmas-page {
            height: 100vh;
            width: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #0a2e38 0%, #1a1a2e 100%);
        }
        
        /* è§†é¢‘èƒŒæ™¯å®¹å™¨ */
        .video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .video-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.7) contrast(1.2);
        }
        
        /* å†…å®¹åŒºåŸŸ */
        .main-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            padding: 20px;
        }
        
        /* é›ªèŠ±æ•ˆæœ */
        .snowflake {
            position: absolute;
            color: white;
            font-size: 1.5rem;
            user-select: none;
            z-index: 2;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
            animation: fall linear infinite;
        }
        
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        
        /* æ–°é¡µé¢å®¹å™¨ - åˆå§‹éšè— */
        .couple-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            z-index: 10;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            overflow-y: auto;
        }
        
        .couple-page.show {
            display: flex;
            flex-direction: column;
            opacity: 1;
        }
        
        /* æ–°é¡µé¢å†…å®¹å®¹å™¨ */
        .couple-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
            position: relative;
            z-index: 2;
        }
        
        /* é¡µé¢æ ‡é¢˜ */
        .page-title {
            text-align: center;
            color: white;
            font-size: 3rem;
            margin-bottom: 30px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
            animation: fadeInDown 1s ease-out;
            font-weight: 300;
            letter-spacing: 2px;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* è®°å½•åŒºåŸŸ */
        .memories-section {
            max-width: 900px;
            margin: 0 auto 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .memories-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .memories-header h2 {
            color: white;
            font-size: 1.8rem;
            font-weight: 300;
            margin: 0;
        }
        
        .add-memory-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .add-memory-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .memories-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .memory-item {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            position: relative;
            cursor: pointer;
        }
        
        .memory-item:hover {
            transform: translateY(-5px);
        }
        
        .memory-date {
            font-size: 0.85rem;
            color: #999;
            margin-bottom: 10px;
        }
        
        .memory-content {
            color: #333;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        
        .memory-delete {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 0, 0, 0.1);
            border: none;
            color: #ff4444;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .memory-delete:hover {
            background: rgba(255, 0, 0, 0.2);
        }
        
        /* æ·»åŠ è®°å½•æ¨¡æ€æ¡† */
        .memory-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .memory-modal.show {
            display: flex;
        }
        
        .memory-modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .memory-modal-content h3 {
            margin-top: 0;
            color: #667eea;
        }
        
        .memory-input {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 20px;
        }
        
        .memory-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .modal-btn-cancel {
            background: #f0f0f0;
            color: #333;
        }
        
        .modal-btn-save {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        /* å›å¿†è¯¦æƒ…æ¨¡æ€æ¡† */
        .memory-detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }
        
        .memory-detail-modal.show {
            display: flex;
        }
        
        .memory-detail-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
        }
        
        .memory-detail-header {
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        
        .memory-detail-header h3 {
            margin: 0 0 10px 0;
            color: #667eea;
        }
        
        .memory-detail-date {
            color: #999;
            font-size: 0.9rem;
        }
        
        .memory-detail-text {
            color: #333;
            line-height: 1.8;
            font-size: 1rem;
            margin-bottom: 25px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 10px;
        }
        
        /* ç•™è¨€åŒºåŸŸ */
        .comments-section {
            margin-top: 25px;
            border-top: 2px solid #f0f0f0;
            padding-top: 20px;
        }
        
        .comments-section h4 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .comment-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .comment-date {
            font-size: 0.8rem;
            color: #999;
            margin-bottom: 8px;
        }
        
        .comment-text {
            color: #333;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .comment-images {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .comment-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .comment-image:hover {
            transform: scale(1.1);
        }
        
        /* æ·»åŠ ç•™è¨€è¡¨å• */
        .add-comment-form {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }
        
        .comment-input {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 0.95rem;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 15px;
        }
        
        .comment-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .image-upload-area {
            margin-bottom: 15px;
        }
        
        .image-upload-btn {
            background: #f0f0f0;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }
        
        .image-upload-btn:hover {
            background: #e8e8e8;
            border-color: #667eea;
        }
        
        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .image-preview-item {
            position: relative;
            width: 100px;
            height: 100px;
        }
        
        .image-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .image-preview-item .remove-image {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .submit-comment-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
        }
        
        .submit-comment-btn:hover {
            opacity: 0.9;
        }
        
        /* æ—¥å†å¡ç‰‡ - ç¼©å°å¹¶æ”¾åœ¨è§’è½ */
        .calendar-card {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            animation: fadeInUp 1s ease-out 0.3s both;
            width: 300px;
            z-index: 10;
            backdrop-filter: blur(10px);
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .calendar-card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
        }
        
        /* è¿™ä¸ªå“åº”å¼è§„åˆ™å·²åˆå¹¶åˆ°ä¸‹é¢çš„å®Œæ•´ç§»åŠ¨ç«¯ä¼˜åŒ–ä¸­ */
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .calendar-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-align: center;
        }
        
        /* æ—¥å†æ ·å¼ */
        .calendar {
            width: 100%;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .calendar-nav {
            background: #667eea;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background 0.3s;
        }
        
        .calendar-nav:hover {
            background: #5568d3;
        }
        
        .calendar-month {
            font-size: 0.9rem;
            font-weight: bold;
            color: #333;
        }
        
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 5px;
        }
        
        .calendar-weekday {
            text-align: center;
            font-weight: bold;
            color: #667eea;
            padding: 5px;
            font-size: 0.7rem;
        }
        
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.75rem;
        }
        
        .calendar-day:hover {
            background: #f0f0f0;
        }
        
        .calendar-day.other-month {
            color: #ccc;
        }
        
        .calendar-day.today {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .calendar-day.anniversary {
            background: #ff6b9d;
            color: white;
            font-weight: bold;
        }
        
        /* æ•£å¸ƒçš„è¯è¯­å…ƒç´  */
        .floating-message {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            font-size: 1rem;
            line-height: 1.6;
            color: #333;
            max-width: 250px;
            text-align: center;
            opacity: 0;
            transform: translateY(20px) scale(0.8);
            animation: floatIn 1s ease-out forwards, float 3s ease-in-out infinite;
            z-index: 5;
            border: 2px solid rgba(102, 126, 234, 0.3);
            pointer-events: auto;
            backdrop-filter: blur(5px);
        }
        
        .floating-message::before {
            content: 'ğŸ’•';
            display: block;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        /* ä¸åŒä½ç½®çš„è¯è¯­ä½¿ç”¨ä¸åŒçš„å¿ƒå½¢å›¾æ ‡ */
        .floating-message:nth-child(1)::before { content: 'ğŸ’•'; }
        .floating-message:nth-child(2)::before { content: 'ğŸ’–'; }
        .floating-message:nth-child(3)::before { content: 'ğŸ’—'; }
        .floating-message:nth-child(4)::before { content: 'ğŸ’'; }
        .floating-message:nth-child(5)::before { content: 'ğŸ’'; }
        .floating-message:nth-child(6)::before { content: 'ğŸ’“'; }
        .floating-message:nth-child(7)::before { content: 'ğŸ’•'; }
        .floating-message:nth-child(8)::before { content: 'ğŸ’–'; }
        
        @keyframes floatIn {
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-10px) rotate(2deg);
            }
        }
        
        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-20px) scale(0.8);
            }
        }
        
        .floating-message.fade-out {
            animation: fadeOut 0.5s ease-out forwards;
        }
        
        /* åŠ è½½æç¤º */
        .loading-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            z-index: 100;
            font-size: 1.2rem;
            color: #667eea;
            display: none;
        }
        
        .loading-indicator.show {
            display: block;
            animation: fadeInDown 0.5s ease-out;
        }
        
        .loading-indicator::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        /* å®æ—¶æ—¶é—´æ˜¾ç¤º */
        .real-time {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        /* å“åº”å¼è°ƒæ•´ - ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            .snowflake {
                font-size: 1.2rem;
            }
            .couple-content {
                padding: 15px 10px;
            }
            .calendar-card, .message-card {
                padding: 15px;
            }
            
            /* æ—¥å†å¡ç‰‡ç§»åŠ¨ç«¯ä½ç½® */
            .calendar-card {
                position: relative;
                top: auto;
                right: auto;
                width: 100%;
                margin-bottom: 20px;
                max-width: 100%;
            }
            
            /* é¡µé¢æ ‡é¢˜ */
            .page-title {
                font-size: 1.8rem;
                letter-spacing: 1px;
                margin-bottom: 20px;
            }
            
            /* å®æ—¶æ—¶é—´ */
            .real-time {
                font-size: 1rem;
                margin-bottom: 15px;
                padding: 0 10px;
            }
            
            /* è®°å½•åŒºåŸŸ */
            .memories-section {
                padding: 20px 15px;
                margin-bottom: 20px;
            }
            
            .memories-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .memories-header h2 {
                font-size: 1.4rem;
            }
            
            .add-memory-btn {
                width: 100%;
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .memories-list {
                grid-template-columns: 1fr;
                gap: 15px;
                max-height: none;
            }
            
            .memory-item {
                padding: 15px;
            }
            
            .memory-content {
                font-size: 0.9rem;
            }
            
            /* æ¨¡æ€æ¡† */
            .memory-modal-content,
            .memory-detail-content {
                padding: 20px 15px;
                max-width: 95%;
                max-height: 90vh;
            }
            
            .memory-input,
            .comment-input {
                font-size: 0.9rem;
                padding: 12px;
                min-height: 100px;
            }
            
            /* ç•™è¨€åŒºåŸŸ */
            .comments-section {
                margin-top: 20px;
                padding-top: 15px;
            }
            
            .comment-item {
                padding: 12px;
            }
            
            .comment-image {
                width: 80px;
                height: 80px;
            }
            
            .image-preview-item {
                width: 80px;
                height: 80px;
            }
            
            .image-preview-item img {
                width: 100%;
                height: 100%;
            }
            
            /* æµ®åŠ¨æ¶ˆæ¯ */
            .floating-message {
                max-width: 200px;
                padding: 12px 15px;
                font-size: 0.85rem;
            }
            
            /* åŠ è½½æç¤º */
            .loading-indicator {
                padding: 15px 30px;
                font-size: 1rem;
            }
        }
        
        /* è¶…å°å±å¹•ä¼˜åŒ– */
        @media (max-width: 480px) {
            .page-title {
                font-size: 1.5rem;
                margin-bottom: 15px;
            }
            
            .real-time {
                font-size: 0.9rem;
            }
            
            .memories-section {
                padding: 15px 10px;
            }
            
            .memories-header h2 {
                font-size: 1.2rem;
            }
            
            .memory-item {
                padding: 12px;
            }
            
            .memory-content {
                font-size: 0.85rem;
            }
            
            .floating-message {
                max-width: 160px;
                padding: 10px 12px;
                font-size: 0.8rem;
            }
            
            .calendar-card {
                padding: 12px;
            }
            
            .calendar-card h2 {
                font-size: 1rem;
            }
            
            .calendar-month {
                font-size: 0.8rem;
            }
            
            .calendar-nav {
                padding: 3px 6px;
                font-size: 0.7rem;
            }
            
            .calendar-weekday {
                padding: 4px;
                font-size: 0.65rem;
            }
            
            .calendar-day {
                font-size: 0.7rem;
            }
        }
        
        /* æ¨ªå±ä¼˜åŒ– */
        @media (max-width: 768px) and (orientation: landscape) {
            .couple-content {
                padding: 10px;
            }
            
            .page-title {
                font-size: 1.5rem;
                margin-bottom: 15px;
            }
            
            .memories-section {
                padding: 15px;
            }
            
            .memories-list {
                max-height: 300px;
            }
        }
    </style>
</head>

<body>
    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="backgroundMusic" autoplay loop>
        <source src="å¾ˆç¾å‘³ -ä¸çµä¸çµ.MP3" type="audio/mpeg">
        <source src="å¾ˆç¾å‘³ -ä¸çµä¸çµ.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
    </audio>
    
    <div class="christmas-page">
        <div class="video-container">
            <video id="christmasVideo" autoplay muted playsinline>
                <source src="åœ£è¯å¿«ä¹.mp4" type="video/mp4">
                æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
            </video>
        </div>
        
        <div class="main-content">
            <!-- ç§»é™¤äº†æ‰€æœ‰æ–‡å­—å†…å®¹ -->
        </div>
    </div>
    
    <!-- æ–°é¡µé¢ï¼šæƒ…ä¾£æ—¥å†å’Œè¯è¯­ -->
    <div class="couple-page" id="couplePage">
        <div class="couple-content">
            <h1 class="page-title">ğŸ’• å°æ˜ŸAndå°æ™º ğŸ’•</h1>
            
            <div class="real-time" id="realTime"></div>
            
            <!-- è®°å½•åŒºåŸŸ -->
            <div class="memories-section">
                <div class="memories-header">
                    <h2>ğŸ“ æˆ‘ä»¬çš„æ•…äº‹</h2>
                    <button class="add-memory-btn" onclick="showAddMemoryModal()">+ æ·»åŠ å›å¿†</button>
                </div>
                <div class="memories-list" id="memoriesList">
                    <!-- å›å¿†è®°å½•å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                </div>
            </div>
            
            <!-- æ—¥å†å¡ç‰‡ - ç¼©å°æ”¾åœ¨å³ä¸Šè§’ -->
            <div class="calendar-card">
                <h2>ğŸ“…</h2>
                <div class="calendar" id="calendar"></div>
            </div>
            
            <!-- æ•£å¸ƒçš„è¯è¯­å®¹å™¨ -->
            <div id="messagesContainer" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; min-height: 100vh; pointer-events: none;"></div>
            
            <!-- åŠ è½½æç¤º -->
            <div class="loading-indicator" id="loadingIndicator">
                æ­£åœ¨ç”Ÿæˆæ¸©é¦¨çš„åœ£è¯ç¥ç¦
            </div>
            
            <!-- æ·»åŠ è®°å½•æ¨¡æ€æ¡† -->
            <div class="memory-modal" id="memoryModal">
                <div class="memory-modal-content">
                    <h3>ğŸ’Œ è®°å½•æˆ‘ä»¬çš„å›å¿†</h3>
                    <textarea class="memory-input" id="memoryInput" placeholder="å†™ä¸‹ä½ ä»¬çš„ç¾å¥½ç¬é—´..."></textarea>
                    <div class="modal-buttons">
                        <button class="modal-btn modal-btn-cancel" onclick="hideAddMemoryModal()">å–æ¶ˆ</button>
                        <button class="modal-btn modal-btn-save" onclick="saveMemory()">ä¿å­˜</button>
                    </div>
                </div>
            </div>
            
            <!-- å›å¿†è¯¦æƒ…æ¨¡æ€æ¡† -->
            <div class="memory-detail-modal" id="memoryDetailModal">
                <div class="memory-detail-content">
                    <div class="memory-detail-header">
                        <h3 id="detailMemoryTitle">ğŸ’• æˆ‘ä»¬çš„å›å¿†</h3>
                        <div class="memory-detail-date" id="detailMemoryDate"></div>
                    </div>
                    <div class="memory-detail-text" id="detailMemoryContent"></div>
                    
                    <div class="comments-section">
                        <h4>ğŸ’¬ ç•™è¨€</h4>
                        <div id="commentsList"></div>
                        
                        <div class="add-comment-form">
                            <textarea class="comment-input" id="commentInput" placeholder="å†™ä¸‹ä½ çš„ç•™è¨€..."></textarea>
                            
                            <div class="image-upload-area">
                                <div class="image-upload-btn" onclick="document.getElementById('imageInput').click()">
                                    ğŸ“· ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡
                                </div>
                                <input type="file" id="imageInput" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">
                                <div class="image-preview" id="imagePreview"></div>
                            </div>
                            
                            <button class="submit-comment-btn" onclick="submitComment()">å‘è¡¨ç•™è¨€</button>
                        </div>
                    </div>
                    
                    <div style="text-align: right; margin-top: 20px;">
                        <button class="modal-btn modal-btn-cancel" onclick="hideMemoryDetail()">å…³é—­</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ============================================================================
        // âš ï¸âš ï¸âš ï¸ é‡è¦é…ç½®åŒºåŸŸï¼šDeepSeek APIå¯†é’¥é…ç½® âš ï¸âš ï¸âš ï¸
        // ============================================================================
        // å·²å¡«å…¥æ‚¨çš„DeepSeek APIå¯†é’¥
        // DeepSeekä½¿ç”¨æ ‡å‡†çš„OpenAIå…¼å®¹APIæ ¼å¼
        // ============================================================================
        const DEEPSEEK_API_KEY = 'sk-54080103e6954b16b42817af05a9088b';
        const DEEPSEEK_API_URL = 'https://api.deepseek.com/v1/chat/completions';  // DeepSeek APIåœ°å€
        const DEEPSEEK_MODEL = 'deepseek-chat';  // DeepSeekæ¨¡å‹åç§°
        
        // ============================================================================
        // GitHub æ•°æ®åŒæ­¥é…ç½®ï¼ˆå¯é€‰ï¼‰
        // ============================================================================
        // å¦‚æœéœ€è¦è®©å…¶ä»–äººä¹Ÿèƒ½çœ‹åˆ°å›å¿†ï¼Œè¯·é…ç½® GitHub Personal Access Token
        // 1. è®¿é—® https://github.com/settings/tokens
        // 2. ç‚¹å‡» "Generate new token (classic)"
        // 3. å‹¾é€‰ "repo" æƒé™
        // 4. å°†ç”Ÿæˆçš„ token å¡«å…¥ä¸‹é¢çš„ GITHUB_TOKEN
        // 5. æ•°æ®å°†ä¿å­˜åˆ° GitHub ä»“åº“çš„ memories.json æ–‡ä»¶ä¸­
        // ============================================================================
        const GITHUB_TOKEN = '';  // âš ï¸ å¯é€‰ï¼šå¡«å…¥æ‚¨çš„ GitHub Personal Access Tokenï¼ˆå¦‚æœéœ€è¦åŒæ­¥æ•°æ®ï¼‰
        const GITHUB_REPO = 'lzh626366/-And-';  // GitHub ä»“åº“å
        const GITHUB_FILE = 'memories.json';  // ä¿å­˜æ•°æ®çš„æ–‡ä»¶å
        // ============================================================================
        
        // å½“å‰æ˜¾ç¤ºçš„æœˆä»½å’Œå¹´ä»½
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        
        // èµ·å§‹æ—¥æœŸï¼š2025å¹´8æœˆ22æ—¥
        const startDate = new Date(2025, 7, 22); // æœˆä»½ä»0å¼€å§‹ï¼Œæ‰€ä»¥7è¡¨ç¤º8æœˆ
        
        // è·Ÿè¸ªå·²ä½¿ç”¨çš„ä½ç½®ï¼Œé¿å…é‡å 
        const usedPositions = [];
        
        // è®¡ç®—ä»èµ·å§‹æ—¥æœŸåˆ°ç°åœ¨çš„å¤©æ•°
        function getDaysSinceStart() {
            const now = new Date();
            const diffTime = now - startDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }
        
        // çºªå¿µæ—¥ï¼ˆå¯ä»¥è‡ªå®šä¹‰æ·»åŠ ï¼‰
        const anniversaries = [
            { month: 8, day: 22, name: 'å¼€å§‹çš„æ—¥å­' }, // 2025å¹´8æœˆ22æ—¥
            { month: 12, day: 25, name: 'åœ£è¯èŠ‚' },
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçºªå¿µæ—¥ï¼Œä¾‹å¦‚ï¼š
            // { month: 1, day: 1, name: 'å…ƒæ—¦' },
            // { month: 2, day: 14, name: 'æƒ…äººèŠ‚' },
        ];
        
        // åˆ›å»ºé›ªèŠ±æ•ˆæœ
        function createSnowflakes() {
            const snowflakesContainer = document.createElement('div');
            snowflakesContainer.className = 'snowflakes-container';
            document.querySelector('.christmas-page').appendChild(snowflakesContainer);
            
            const snowflakeSymbols = ['â„', 'â…', 'â†', 'â€¢', '*'];
            
            for (let i = 0; i < 80; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.textContent = snowflakeSymbols[Math.floor(Math.random() * snowflakeSymbols.length)];
                
                // éšæœºä½ç½®
                snowflake.style.left = Math.random() * 100 + 'vw';
                
                // éšæœºå¤§å°
                const size = Math.random() * 1.5 + 0.8;
                snowflake.style.fontSize = size + 'rem';
                
                // éšæœºé€æ˜åº¦
                snowflake.style.opacity = Math.random() * 0.7 + 0.3;
                
                // éšæœºåŠ¨ç”»æ—¶é•¿
                const duration = Math.random() * 10 + 5;
                snowflake.style.animationDuration = duration + 's';
                
                // éšæœºå»¶è¿Ÿ
                snowflake.style.animationDelay = Math.random() * 5 + 's';
                
                snowflakesContainer.appendChild(snowflake);
            }
        }
        
        // è§†é¢‘æ’­æ”¾ç»“æŸï¼Œæ˜¾ç¤ºæ–°é¡µé¢
        async function showCouplePage() {
            const couplePage = document.getElementById('couplePage');
            couplePage.classList.add('show');
            initCalendar();
            updateRealTime();
            
            // ä» GitHub åŠ è½½å›å¿†æ•°æ®ï¼ˆå¦‚æœé…ç½®äº† tokenï¼‰
            await loadMemoriesFromGitHub();
            
            renderMemories(); // æ¸²æŸ“å›å¿†åˆ—è¡¨
            // è‡ªåŠ¨ç”Ÿæˆå¤šæ¡ç¥ç¦è¯­å¹¶æ•£å¸ƒåœ¨å±å¹•ä¸Š
            generateMultipleMessages();
        }
        
        // æ›´æ–°å®æ—¶æ—¶é—´
        function updateRealTime() {
            const realTimeEl = document.getElementById('realTime');
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                weekday: 'long'
            };
            
            // è®¡ç®—ä»2025å¹´8æœˆ22æ—¥åˆ°ç°åœ¨å·²ç»è¿‡äº†å¤šå°‘å¤©
            const daysSinceStart = getDaysSinceStart();
            const daysText = daysSinceStart >= 0 
                ? `ğŸ’• æˆ‘ä»¬å·²ç»åœ¨ä¸€èµ· ${daysSinceStart} å¤©äº† ğŸ’•` 
                : `ğŸ’• è·ç¦»å¼€å§‹è¿˜æœ‰ ${Math.abs(daysSinceStart)} å¤© ğŸ’•`;
            
            realTimeEl.innerHTML = `
                <div style="margin-bottom: 10px;">${daysText}</div>
                <div style="font-size: 0.9em; opacity: 0.9;">ğŸ• ${now.toLocaleDateString('zh-CN', options)}</div>
            `;
            
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡
            setTimeout(updateRealTime, 1000);
        }
        
        // åˆå§‹åŒ–æ—¥å†
        function initCalendar() {
            renderCalendar();
        }
        
        // æ¸²æŸ“æ—¥å†
        function renderCalendar() {
            const calendarEl = document.getElementById('calendar');
            const today = new Date();
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            // æ˜ŸæœŸæ•°ç»„
            const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            
            let html = `
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="previousMonth()">â€¹ ä¸Šæœˆ</button>
                    <div class="calendar-month">${currentYear}å¹´ ${currentMonth + 1}æœˆ</div>
                    <button class="calendar-nav" onclick="nextMonth()">ä¸‹æœˆ â€º</button>
                </div>
                <div class="calendar-weekdays">
            `;
            
            // æ˜ŸæœŸæ ‡é¢˜
            weekdays.forEach(day => {
                html += `<div class="calendar-weekday">${day}</div>`;
            });
            html += `</div><div class="calendar-days">`;
            
            // ä¸Šä¸ªæœˆçš„æ—¥æœŸ
            const prevMonthLastDay = new Date(currentYear, currentMonth, 0).getDate();
            for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                html += `<div class="calendar-day other-month">${prevMonthLastDay - i}</div>`;
            }
            
            // å½“å‰æœˆçš„æ—¥æœŸ
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = today.getDate() === day && 
                               today.getMonth() === currentMonth && 
                               today.getFullYear() === currentYear;
                const isAnniversary = anniversaries.some(a => 
                    a.month === currentMonth + 1 && a.day === day
                );
                
                let dayClass = 'calendar-day';
                if (isToday) dayClass += ' today';
                if (isAnniversary) dayClass += ' anniversary';
                
                html += `<div class="${dayClass}">${day}</div>`;
            }
            
            // ä¸‹ä¸ªæœˆçš„æ—¥æœŸï¼ˆå¡«å……å‰©ä½™æ ¼å­ï¼‰
            const totalCells = startingDayOfWeek + daysInMonth;
            const remainingCells = 42 - totalCells; // 6è¡Œ x 7åˆ— = 42
            for (let day = 1; day <= remainingCells && day <= 14; day++) {
                html += `<div class="calendar-day other-month">${day}</div>`;
            }
            
            html += `</div>`;
            calendarEl.innerHTML = html;
        }
        
        // ä¸Šä¸€ä¸ªæœˆ
        function previousMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }
        
        // ä¸‹ä¸€ä¸ªæœˆ
        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }
        
        // ç”ŸæˆHMAC-SHA256ç­¾å
        async function generateSignature(secretKey, stringToSign) {
            const encoder = new TextEncoder();
            const keyData = encoder.encode(secretKey);
            const messageData = encoder.encode(stringToSign);
            
            const cryptoKey = await crypto.subtle.importKey(
                'raw',
                keyData,
                { name: 'HMAC', hash: 'SHA-256' },
                false,
                ['sign']
            );
            
            const signature = await crypto.subtle.sign('HMAC', cryptoKey, messageData);
            const hashArray = Array.from(new Uint8Array(signature));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }
        
        // ç”Ÿæˆè¯·æ±‚ç­¾åï¼ˆç«å±±å¼•æ“ç­¾åç®—æ³•ï¼‰
        async function generateRequestSignature(method, uri, query, headers, body, secretKey) {
            // æ„å»ºè§„èŒƒè¯·æ±‚
            const canonicalUri = uri;
            const canonicalQueryString = query || '';
            
            // è§„èŒƒå¤´éƒ¨
            const canonicalHeaders = Object.keys(headers)
                .sort()
                .map(key => `${key.toLowerCase()}:${headers[key]}\n`)
                .join('');
            
            const signedHeaders = Object.keys(headers)
                .sort()
                .map(key => key.toLowerCase())
                .join(';');
            
            // è¯·æ±‚ä½“å“ˆå¸Œ
            const hashedPayload = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(body || ''));
            const payloadHash = Array.from(new Uint8Array(hashedPayload))
                .map(b => b.toString(16).padStart(2, '0'))
                .join('');
            
            // æ„å»ºå¾…ç­¾åå­—ç¬¦ä¸²
            const canonicalRequest = `${method}\n${canonicalUri}\n${canonicalQueryString}\n${canonicalHeaders}\n${signedHeaders}\n${payloadHash}`;
            
            // ç”Ÿæˆç­¾å
            const signature = await generateSignature(secretKey, canonicalRequest);
            return signature;
        }
        
        // å­˜å‚¨å›å¿†è®°å½•
        let memories = JSON.parse(localStorage.getItem('coupleMemories') || '[]');
        
        // ç¡®ä¿æ—§æ•°æ®å…¼å®¹æ€§ï¼šä¸ºæ²¡æœ‰commentså­—æ®µçš„å›å¿†æ·»åŠ ç©ºæ•°ç»„
        memories.forEach(memory => {
            if (!memory.comments) {
                memory.comments = [];
            }
        });
        if (memories.length > 0) {
            localStorage.setItem('coupleMemories', JSON.stringify(memories));
        }
        
        // GitHub API å‡½æ•°ï¼šä» GitHub è¯»å–æ•°æ®
        async function loadMemoriesFromGitHub() {
            if (!GITHUB_TOKEN) {
                console.log('æœªé…ç½® GitHub Tokenï¼Œä½¿ç”¨æœ¬åœ°å­˜å‚¨');
                return;
            }
            
            try {
                const url = `https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FILE}`;
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const content = atob(data.content.replace(/\s/g, '')); // è§£ç  base64
                    const githubMemories = JSON.parse(content);
                    
                    // åˆå¹¶æœ¬åœ°å’Œ GitHub çš„æ•°æ®ï¼ˆGitHub ä¼˜å…ˆï¼‰
                    if (githubMemories && githubMemories.length > 0) {
                        memories = githubMemories;
                        localStorage.setItem('coupleMemories', JSON.stringify(memories));
                        renderMemories();
                        console.log('ä» GitHub åŠ è½½äº†å›å¿†æ•°æ®');
                    }
                } else if (response.status === 404) {
                    console.log('GitHub ä¸Šè¿˜æ²¡æœ‰æ•°æ®æ–‡ä»¶ï¼Œå°†ä½¿ç”¨æœ¬åœ°æ•°æ®');
                } else {
                    console.error('ä» GitHub åŠ è½½æ•°æ®å¤±è´¥:', response.status);
                }
            } catch (error) {
                console.error('åŠ è½½ GitHub æ•°æ®å‡ºé”™:', error);
            }
        }
        
        // GitHub API å‡½æ•°ï¼šä¿å­˜æ•°æ®åˆ° GitHub
        async function saveMemoriesToGitHub() {
            if (!GITHUB_TOKEN) {
                console.log('æœªé…ç½® GitHub Tokenï¼Œä»…ä¿å­˜åˆ°æœ¬åœ°');
                return;
            }
            
            try {
                // å…ˆè·å–æ–‡ä»¶ SHAï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                let sha = null;
                try {
                    const getUrl = `https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FILE}`;
                    const getResponse = await fetch(getUrl, {
                        headers: {
                            'Authorization': `token ${GITHUB_TOKEN}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    if (getResponse.ok) {
                        const data = await getResponse.json();
                        sha = data.sha;
                    }
                } catch (e) {
                    // æ–‡ä»¶ä¸å­˜åœ¨ï¼Œsha ä¿æŒä¸º null
                }
                
                // å‡†å¤‡æ•°æ®
                const content = JSON.stringify(memories, null, 2);
                const encodedContent = btoa(unescape(encodeURIComponent(content)));
                
                // ä¸Šä¼ åˆ° GitHub
                const url = `https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FILE}`;
                const body = {
                    message: `Update memories - ${new Date().toLocaleString('zh-CN')}`,
                    content: encodedContent
                };
                
                if (sha) {
                    body.sha = sha; // æ›´æ–°ç°æœ‰æ–‡ä»¶éœ€è¦ SHA
                }
                
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });
                
                if (response.ok) {
                    console.log('æ•°æ®å·²ä¿å­˜åˆ° GitHub');
                } else {
                    const error = await response.json();
                    console.error('ä¿å­˜åˆ° GitHub å¤±è´¥:', error);
                }
            } catch (error) {
                console.error('ä¿å­˜åˆ° GitHub å‡ºé”™:', error);
            }
        }
        
        // æ˜¾ç¤ºæ·»åŠ å›å¿†æ¨¡æ€æ¡†
        function showAddMemoryModal() {
            document.getElementById('memoryModal').classList.add('show');
            document.getElementById('memoryInput').focus();
        }
        
        // éšè—æ·»åŠ å›å¿†æ¨¡æ€æ¡†
        function hideAddMemoryModal() {
            document.getElementById('memoryModal').classList.remove('show');
            document.getElementById('memoryInput').value = '';
        }
        
        // ä¿å­˜å›å¿†
        async function saveMemory() {
            const content = document.getElementById('memoryInput').value.trim();
            if (!content) {
                alert('è¯·è¾“å…¥å›å¿†å†…å®¹');
                return;
            }
            
            const memory = {
                id: Date.now(),
                content: content,
                date: new Date().toLocaleString('zh-CN'),
                comments: [] // åˆå§‹åŒ–ç•™è¨€æ•°ç»„
            };
            
            memories.unshift(memory); // æ·»åŠ åˆ°å¼€å¤´
            localStorage.setItem('coupleMemories', JSON.stringify(memories));
            
            // åŒæ—¶ä¿å­˜åˆ° GitHubï¼ˆå¦‚æœé…ç½®äº† tokenï¼‰
            await saveMemoriesToGitHub();
            
            renderMemories();
            hideAddMemoryModal();
        }
        
        // åˆ é™¤å›å¿†
        async function deleteMemory(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å›å¿†å—ï¼Ÿ')) {
                memories = memories.filter(m => m.id !== id);
                localStorage.setItem('coupleMemories', JSON.stringify(memories));
                
                // åŒæ—¶æ›´æ–° GitHub
                await saveMemoriesToGitHub();
                
                renderMemories();
            }
        }
        
        // å½“å‰æŸ¥çœ‹çš„å›å¿†ID
        let currentMemoryId = null;
        let currentImageFiles = [];
        
        // æ‰“å¼€å›å¿†è¯¦æƒ…
        function openMemoryDetail(id) {
            const memory = memories.find(m => m.id === id);
            if (!memory) return;
            
            currentMemoryId = id;
            currentImageFiles = [];
            
            // å¡«å……è¯¦æƒ…å†…å®¹
            document.getElementById('detailMemoryDate').textContent = memory.date;
            document.getElementById('detailMemoryContent').textContent = memory.content;
            
            // æ¸²æŸ“ç•™è¨€
            renderComments(memory.comments || []);
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('commentInput').value = '';
            document.getElementById('imagePreview').innerHTML = '';
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            document.getElementById('memoryDetailModal').classList.add('show');
        }
        
        // å…³é—­å›å¿†è¯¦æƒ…
        function hideMemoryDetail() {
            document.getElementById('memoryDetailModal').classList.remove('show');
            currentMemoryId = null;
            currentImageFiles = [];
        }
        
        // æ¸²æŸ“ç•™è¨€åˆ—è¡¨
        function renderComments(comments) {
            const commentsList = document.getElementById('commentsList');
            if (!comments || comments.length === 0) {
                commentsList.innerHTML = '<div style="text-align: center; color: #999; padding: 20px;">è¿˜æ²¡æœ‰ç•™è¨€ï¼Œå¿«æ¥ç¬¬ä¸€æ¡å§~</div>';
                return;
            }
            
            commentsList.innerHTML = comments.map(comment => `
                <div class="comment-item">
                    <div class="comment-date">${comment.date}</div>
                    <div class="comment-text">${comment.text}</div>
                    ${comment.images && comment.images.length > 0 ? `
                        <div class="comment-images">
                            ${comment.images.map(img => `
                                <img src="${img}" alt="å›¾ç‰‡" class="comment-image" onclick="showImageModal('${img}')">
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }
        
        // å¤„ç†å›¾ç‰‡ä¸Šä¼ 
        function handleImageUpload(event) {
            const files = Array.from(event.target.files);
            const preview = document.getElementById('imagePreview');
            
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageData = e.target.result;
                        currentImageFiles.push(imageData);
                        
                        const previewItem = document.createElement('div');
                        previewItem.className = 'image-preview-item';
                        previewItem.innerHTML = `
                            <img src="${imageData}" alt="é¢„è§ˆ">
                            <button class="remove-image" onclick="removePreviewImage(this, '${imageData}')">Ã—</button>
                        `;
                        preview.appendChild(previewItem);
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
        
        // ç§»é™¤é¢„è§ˆå›¾ç‰‡
        function removePreviewImage(button, imageData) {
            currentImageFiles = currentImageFiles.filter(img => img !== imageData);
            button.parentElement.remove();
        }
        
        // æäº¤ç•™è¨€
        async function submitComment() {
            const commentText = document.getElementById('commentInput').value.trim();
            if (!commentText && currentImageFiles.length === 0) {
                alert('è¯·è¾“å…¥ç•™è¨€æˆ–ä¸Šä¼ å›¾ç‰‡');
                return;
            }
            
            const memory = memories.find(m => m.id === currentMemoryId);
            if (!memory) return;
            
            if (!memory.comments) {
                memory.comments = [];
            }
            
            const comment = {
                id: Date.now(),
                text: commentText,
                date: new Date().toLocaleString('zh-CN'),
                images: [...currentImageFiles]
            };
            
            memory.comments.push(comment);
            localStorage.setItem('coupleMemories', JSON.stringify(memories));
            
            // åŒæ—¶ä¿å­˜åˆ° GitHub
            await saveMemoriesToGitHub();
            
            // é‡æ–°æ¸²æŸ“ç•™è¨€
            renderComments(memory.comments);
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('commentInput').value = '';
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('imageInput').value = '';
            currentImageFiles = [];
        }
        
        // æ˜¾ç¤ºå›¾ç‰‡å¤§å›¾
        function showImageModal(imageSrc) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                z-index: 2000;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            `;
            modal.onclick = () => modal.remove();
            
            const img = document.createElement('img');
            img.src = imageSrc;
            img.style.cssText = 'max-width: 90%; max-height: 90%; object-fit: contain;';
            modal.appendChild(img);
            document.body.appendChild(modal);
        }
        
        // æ¸²æŸ“å›å¿†åˆ—è¡¨
        function renderMemories() {
            const memoriesList = document.getElementById('memoriesList');
            if (memories.length === 0) {
                memoriesList.innerHTML = '<div style="text-align: center; color: rgba(255,255,255,0.7); padding: 40px;">è¿˜æ²¡æœ‰å›å¿†ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€æ¡å§~</div>';
                return;
            }
            
            memoriesList.innerHTML = memories.map(memory => `
                <div class="memory-item" onclick="openMemoryDetail(${memory.id})">
                    <button class="memory-delete" onclick="event.stopPropagation(); deleteMemory(${memory.id})">Ã—</button>
                    <div class="memory-date">${memory.date}</div>
                    <div class="memory-content">${memory.content}</div>
                    ${memory.comments && memory.comments.length > 0 ? `
                        <div style="margin-top: 10px; font-size: 0.85rem; color: #667eea;">
                            ğŸ’¬ ${memory.comments.length} æ¡ç•™è¨€
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }
        
        // è°ƒç”¨DeepSeek APIç”Ÿæˆå•æ¡åœ£è¯ç¥ç¦è¯­ï¼ˆå¤šæ ·åŒ–ï¼Œåªç”Ÿæˆä¸€å¥è¯ï¼‰
        async function generateSingleMessage(index) {
            try {
                // å¤šæ ·åŒ–çš„æç¤ºè¯æ¨¡æ¿ï¼Œç¡®ä¿åªç”Ÿæˆä¸€å¥è¯
                const promptTemplates = [
                    `è¯·ç”Ÿæˆä¸€å¥${['æ¸©é¦¨æµªæ¼«', 'ç”œèœœåŠ¨äºº', 'æ·±æƒ…æ¬¾æ¬¾', 'æ¸©æš–å¦‚æ˜¥'][index % 4]}çš„åœ£è¯èŠ‚æƒ…ä¾£ç¥ç¦è¯­ï¼Œè¦æ±‚ï¼šåªç”Ÿæˆä¸€å¥è¯ï¼Œ${['æ¸©é¦¨æµªæ¼«', 'ç”œèœœåŠ¨äºº', 'æ·±æƒ…æ¬¾æ¬¾', 'æ¸©æš–å¦‚æ˜¥'][index % 4]}ï¼Œé€‚åˆæƒ…ä¾£ä¹‹é—´ï¼ŒåŒ…å«åœ£è¯å…ƒç´ ï¼Œ20-40å­—ï¼Œè¡¨è¾¾å¯¹å½¼æ­¤çš„çˆ±æ„å’Œåœ£è¯ç¥ç¦ï¼Œè¯­è¨€ä¼˜ç¾${['æœ‰è¯—æ„', 'æœ‰ç”»é¢æ„Ÿ', 'å……æ»¡æƒ…æ„Ÿ', 'çœŸæŒšåŠ¨äºº'][index % 4]}ã€‚åªè¾“å‡ºè¿™ä¸€å¥è¯ï¼Œä¸è¦å…¶ä»–å†…å®¹ã€‚`,
                    `è¯·åˆ›ä½œä¸€å¥${['åˆ«å…·ä¸€æ ¼', 'ç‹¬ç‰¹æ–°é¢–', 'å¯Œæœ‰åˆ›æ„', 'ä¸ä¼—ä¸åŒ'][index % 4]}çš„åœ£è¯èŠ‚æƒ…ä¾£ç¥ç¦è¯­ï¼Œ${['å¯ä»¥æ˜¯å¯¹è¯å½¢å¼', 'å¯ä»¥æ˜¯è¯—æ­Œå½¢å¼', 'å¯ä»¥æ˜¯å†…å¿ƒç‹¬ç™½', 'å¯ä»¥æ˜¯è®¸æ„¿å½¢å¼'][index % 4]}ï¼Œè¦æ±‚ï¼šåªç”Ÿæˆä¸€å¥è¯ï¼Œè¯­è¨€${['æ¸©é¦¨', 'ç”œèœœ', 'æ·±æƒ…', 'æ¸©æš–'][index % 4]}ï¼ŒåŒ…å«åœ£è¯å…ƒç´ ï¼Œ20-40å­—ï¼Œè¡¨è¾¾çˆ±æ„å’Œç¥ç¦ï¼Œè¯­è¨€ä¼˜ç¾ã€‚åªè¾“å‡ºè¿™ä¸€å¥è¯ã€‚`,
                    `è¯·å†™ä¸€å¥${['æµªæ¼«', 'ç”œèœœ', 'æ¸©é¦¨', 'æ·±æƒ…'][index % 4]}çš„åœ£è¯èŠ‚æƒ…ä¾£ç¥ç¦è¯­ï¼Œ${['å¯ä»¥æåˆ°é›ªèŠ±', 'å¯ä»¥æåˆ°æ˜Ÿå…‰', 'å¯ä»¥æåˆ°ç¤¼ç‰©', 'å¯ä»¥æåˆ°åœ£è¯æ ‘'][index % 4]}ï¼Œè¦æ±‚ï¼šåªç”Ÿæˆä¸€å¥è¯ï¼Œé€‚åˆæƒ…ä¾£ä¹‹é—´ï¼ŒåŒ…å«åœ£è¯å…ƒç´ ï¼Œ20-40å­—ï¼Œè¡¨è¾¾çˆ±æ„ï¼Œè¯­è¨€ä¼˜ç¾æœ‰è¯—æ„ã€‚åªè¾“å‡ºè¿™ä¸€å¥è¯ã€‚`,
                    `è¯·ç”Ÿæˆä¸€å¥${['å……æ»¡çˆ±æ„', 'æ¸©æš–äººå¿ƒ', 'ç”œèœœæµªæ¼«', 'æ·±æƒ…æ¬¾æ¬¾'][index % 4]}çš„åœ£è¯èŠ‚æƒ…ä¾£ç¥ç¦è¯­ï¼Œ${['é£æ ¼å¯ä»¥æ˜¯', 'è¯­è°ƒå¯ä»¥æ˜¯', 'æƒ…æ„Ÿå¯ä»¥æ˜¯', 'è¡¨è¾¾æ–¹å¼å¯ä»¥æ˜¯'][index % 4]}${['æ¸©æŸ”ç»†è…»', 'çƒ­æƒ…æ´‹æº¢', 'æ·±æƒ…å†…æ•›', 'æµªæ¼«å¥”æ”¾'][index % 4]}ï¼Œè¦æ±‚ï¼šåªç”Ÿæˆä¸€å¥è¯ï¼Œé€‚åˆæƒ…ä¾£ï¼Œæœ‰åœ£è¯å…ƒç´ ï¼Œ20-40å­—ï¼Œè¡¨è¾¾ç¥ç¦å’Œçˆ±æ„ï¼Œè¯­è¨€ä¼˜ç¾ã€‚åªè¾“å‡ºè¿™ä¸€å¥è¯ã€‚`
                ];
                
                // éšæœºé€‰æ‹©æç¤ºè¯æ¨¡æ¿ï¼Œå¹¶æ·»åŠ æ›´å¤šå˜åŒ–
                const basePrompt = promptTemplates[index % promptTemplates.length];
                const randomVariations = [
                    'è¯·ç”¨ä¸åŒçš„è¡¨è¾¾æ–¹å¼ï¼Œç¡®ä¿ä¸ä¹‹å‰ç”Ÿæˆçš„å†…å®¹é£æ ¼ä¸åŒ',
                    'è¯·é¿å…ä½¿ç”¨å¸¸è§çš„ç¥ç¦è¯­ï¼Œåˆ›ä½œç‹¬ç‰¹çš„è¡¨è¾¾',
                    'è¯·ç”¨æ–°é¢–çš„æ¯”å–»ï¼Œç¡®ä¿ä¸ä¹‹å‰ç”Ÿæˆçš„å†…å®¹é£æ ¼ä¸åŒ',
                    'è¯·ç”¨ä¸åŒçš„è§’åº¦ï¼Œç¡®ä¿ä¸ä¹‹å‰ç”Ÿæˆçš„å†…å®¹é£æ ¼ä¸åŒ',
                    'è¯·åˆ›ä½œç‹¬ç‰¹çš„è¡¨è¾¾ï¼Œç¡®ä¿ä¸ä¹‹å‰ç”Ÿæˆçš„å†…å®¹é£æ ¼ä¸åŒ'
                ];
                const prompt = basePrompt + 'ã€‚' + randomVariations[index % randomVariations.length] + 'ã€‚';

                // æ„å»ºè¯·æ±‚ä½“ - ä½¿ç”¨æ›´é«˜çš„temperatureå¢åŠ å¤šæ ·æ€§ï¼Œå‡å°‘max_tokenså› ä¸ºåªéœ€è¦ä¸€å¥è¯
                const requestBody = {
                    model: DEEPSEEK_MODEL,
                    messages: [
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    temperature: 0.95 + (index * 0.01), // æ¯ä¸ªæ¶ˆæ¯ä½¿ç”¨ä¸åŒçš„temperature
                    max_tokens: 50, // åªéœ€è¦ä¸€å¥è¯ï¼Œå‡å°‘tokenæ•°
                    top_p: 0.9
                };
                
                // æ„å»ºè¯·æ±‚å¤´ - DeepSeekä½¿ç”¨æ ‡å‡†çš„Bearer Tokenè®¤è¯
                const headers = {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
                };

                // è°ƒç”¨DeepSeek API
                const response = await fetch(DEEPSEEK_API_URL, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                
                // æå–ç”Ÿæˆçš„æ–‡æœ¬ï¼ˆDeepSeekä½¿ç”¨æ ‡å‡†çš„OpenAIæ ¼å¼ï¼‰
                let message = '';
                if (data.choices && data.choices[0] && data.choices[0].message) {
                    message = data.choices[0].message.content.trim();
                    // å¦‚æœç”Ÿæˆçš„å†…å®¹åŒ…å«å¤šå¥è¯ï¼Œåªå–ç¬¬ä¸€å¥
                    const sentences = message.split(/[ã€‚ï¼ï¼Ÿ\n]/).filter(s => s.trim().length > 0);
                    if (sentences.length > 0) {
                        message = sentences[0].trim();
                        // å¦‚æœç¬¬ä¸€å¥æ²¡æœ‰æ ‡ç‚¹ï¼Œæ·»åŠ å¥å·
                        if (!/[ã€‚ï¼ï¼Ÿ]$/.test(message)) {
                            message += 'ã€‚';
                        }
                    }
                } else {
                    console.log('APIå“åº”æ•°æ®:', data);
                    // å¦‚æœæ— æ³•è§£æï¼Œä½¿ç”¨å¤‡ç”¨ç¥ç¦è¯­
                    message = 'åœ¨è¿™ä¸ªæ¸©é¦¨çš„åœ£è¯å¤œï¼Œæ„¿æˆ‘ä»¬çš„çˆ±æƒ…å¦‚é›ªèŠ±èˆ¬çº¯æ´ï¼Œå¦‚æ˜Ÿå…‰èˆ¬é—ªè€€ï¼Œæ°¸è¿œç›¸ä¼´ï¼Œåœ£è¯å¿«ä¹ï¼';
                }
                
                return message;
                
            } catch (error) {
                console.error('ç”Ÿæˆç¥ç¦è¯­å¤±è´¥:', error);
                // è¿”å›å¤‡ç”¨ç¥ç¦è¯­ï¼ˆä¸€å¥è¯ï¼‰
                const fallbackMessages = [
                    'åœ¨è¿™ä¸ªæ¸©é¦¨çš„åœ£è¯å¤œï¼Œæ„¿æˆ‘ä»¬çš„çˆ±æƒ…å¦‚é›ªèŠ±èˆ¬çº¯æ´ï¼Œå¦‚æ˜Ÿå…‰èˆ¬é—ªè€€ï¼Œæ°¸è¿œç›¸ä¼´ï¼Œåœ£è¯å¿«ä¹ï¼',
                    'åœ£è¯çš„é’Ÿå£°å“èµ·ï¼Œæ„¿æˆ‘ä»¬çš„çˆ±æƒ…å¦‚åœ£è¯æ ‘ä¸Šçš„å½©ç¯ï¼Œæ°¸è¿œé—ªé—ªå‘å…‰ï¼Œæ¸©æš–å½¼æ­¤çš„å¿ƒæˆ¿ã€‚',
                    'é›ªèŠ±é£˜è½çš„å­£èŠ‚ï¼Œæˆ‘æƒ³å¯¹ä½ è¯´ï¼šæœ‰ä½ é™ªä¼´çš„æ¯ä¸€å¤©ï¼Œéƒ½æ˜¯æˆ‘æœ€çè´µçš„åœ£è¯ç¤¼ç‰©ã€‚',
                    'æ„¿è¿™ä¸ªåœ£è¯ï¼Œæˆ‘ä»¬çš„çˆ±æƒ…å¦‚é›ªèŠ±èˆ¬çº¯å‡€ï¼Œå¦‚æ˜Ÿå…‰èˆ¬ç’€ç’¨ï¼Œæ°¸è¿œç›¸å®ˆï¼Œæ°¸ä¸åˆ†ç¦»ã€‚',
                    'åœ£è¯çš„å¤œæ™šï¼Œæœ‰ä½ åœ¨èº«è¾¹ï¼Œå°±æ˜¯æˆ‘æœ€æƒ³è¦çš„ç¤¼ç‰©ã€‚æ„¿æˆ‘ä»¬çš„çˆ±æƒ…æ°¸è¿œå¦‚åˆï¼Œåœ£è¯å¿«ä¹ï¼'
                ];
                return fallbackMessages[index % fallbackMessages.length];
            }
        }
        
        // æ£€æŸ¥ä½ç½®æ˜¯å¦ä¸å·²ä½¿ç”¨çš„ä½ç½®é‡å 
        function isPositionOverlapping(x, y, usedPositions, minDistance = 15) {
            for (const used of usedPositions) {
                const distance = Math.sqrt(Math.pow(x - used.x, 2) + Math.pow(y - used.y, 2));
                if (distance < minDistance) {
                    return true;
                }
            }
            return false;
        }
        
        // åœ¨å±å¹•ä¸Šåˆ›å»ºæ•£å¸ƒçš„è¯è¯­å…ƒç´ 
        function createFloatingMessage(text, index, total) {
            const container = document.getElementById('messagesContainer');
            const messageEl = document.createElement('div');
            messageEl.className = 'floating-message';
            messageEl.textContent = text;
            
            // é¢„å®šä¹‰çš„ä½ç½®åŒºåŸŸï¼ˆç™¾åˆ†æ¯”ï¼‰- åªä½¿ç”¨å·¦ä¸Šè§’ã€å·¦ä¸‹è§’ã€å³ä¸‹è§’
            const basePositions = [
                // å·¦ä¸Šè§’åŒºåŸŸï¼ˆå¤šä¸ªä½ç½®é¿å…é‡å ï¼‰
                { x: 5, y: 10 },
                { x: 8, y: 15 },
                { x: 12, y: 20 },
                // å·¦ä¸‹è§’åŒºåŸŸï¼ˆå¤šä¸ªä½ç½®é¿å…é‡å ï¼‰
                { x: 5, y: 65 },
                { x: 8, y: 70 },
                { x: 12, y: 75 },
                // å³ä¸‹è§’åŒºåŸŸï¼ˆå¤šä¸ªä½ç½®é¿å…é‡å ï¼‰
                { x: 75, y: 65 },
                { x: 78, y: 70 },
                { x: 82, y: 75 }
            ];
            
            // å°è¯•æ‰¾åˆ°ä¸€ä¸ªä¸é‡å çš„ä½ç½®
            let finalX, finalY;
            let attempts = 0;
            const maxAttempts = 50;
            
            do {
                // æ ¹æ®ç´¢å¼•é€‰æ‹©åŒºåŸŸï¼š0,1åœ¨å·¦ä¸Šè§’ï¼Œ2,3åœ¨å·¦ä¸‹è§’ï¼Œ4åœ¨å³ä¸‹è§’
                let areaIndex;
                if (index < 2) {
                    // å·¦ä¸Šè§’ï¼ˆå‰2ä¸ªï¼‰
                    areaIndex = index;
                } else if (index < 4) {
                    // å·¦ä¸‹è§’ï¼ˆç¬¬3ã€4ä¸ªï¼‰
                    areaIndex = 3 + (index - 2);
                } else {
                    // å³ä¸‹è§’ï¼ˆç¬¬5ä¸ªï¼‰
                    areaIndex = 6 + (index - 4);
                }
                
                const basePos = basePositions[areaIndex % basePositions.length];
                
                // æ·»åŠ éšæœºåç§»ï¼Œä½†é™åˆ¶èŒƒå›´é¿å…é‡å ï¼Œä¸”ç¡®ä¿åœ¨å¯¹åº”åŒºåŸŸå†…
                const offsetX = (Math.random() - 0.5) * 6; // å‡å°‘åç§»èŒƒå›´
                const offsetY = (Math.random() - 0.5) * 6;
                
                // é™åˆ¶åœ¨å¯¹åº”åŒºåŸŸå†…
                if (index < 2) {
                    // å·¦ä¸Šè§’ï¼šx < 20%, y < 30%
                    finalX = Math.max(3, Math.min(18, basePos.x + offsetX));
                    finalY = Math.max(5, Math.min(28, basePos.y + offsetY));
                } else if (index < 4) {
                    // å·¦ä¸‹è§’ï¼šx < 20%, y > 60%
                    finalX = Math.max(3, Math.min(18, basePos.x + offsetX));
                    finalY = Math.max(60, Math.min(85, basePos.y + offsetY));
                } else {
                    // å³ä¸‹è§’ï¼šx > 70%, y > 60%
                    finalX = Math.max(70, Math.min(90, basePos.x + offsetX));
                    finalY = Math.max(60, Math.min(85, basePos.y + offsetY));
                }
                
                attempts++;
                
                // å¦‚æœå°è¯•æ¬¡æ•°å¤ªå¤šï¼Œä½¿ç”¨åŸºç¡€ä½ç½®
                if (attempts >= maxAttempts) {
                    finalX = basePos.x;
                    finalY = basePos.y;
                    break;
                }
            } while (isPositionOverlapping(finalX, finalY, usedPositions, 12));
            
            // è®°å½•ä½¿ç”¨çš„ä½ç½®
            usedPositions.push({ x: finalX, y: finalY });
            
            messageEl.style.left = finalX + '%';
            messageEl.style.top = finalY + '%';
            
            // éšæœºå»¶è¿Ÿæ˜¾ç¤ºï¼Œå½¢æˆä¾æ¬¡å‡ºç°çš„æ•ˆæœ
            messageEl.style.animationDelay = (index * 0.3) + 's';
            
            // éšæœºæ—‹è½¬è§’åº¦
            const rotation = (Math.random() - 0.5) * 8;
            messageEl.style.transform = `translateY(0) scale(1) rotate(${rotation}deg)`;
            
            container.appendChild(messageEl);
            
            // 10ç§’åè‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                messageEl.classList.add('fade-out');
                // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
                setTimeout(() => {
                    if (messageEl.parentNode) {
                        messageEl.parentNode.removeChild(messageEl);
                    }
                    // ä»å·²ä½¿ç”¨ä½ç½®ä¸­ç§»é™¤
                    const posIndex = usedPositions.findIndex(p => 
                        Math.abs(p.x - finalX) < 1 && Math.abs(p.y - finalY) < 1
                    );
                    if (posIndex > -1) {
                        usedPositions.splice(posIndex, 1);
                    }
                }, 500); // ç­‰å¾…æ·¡å‡ºåŠ¨ç”»å®Œæˆ
            }, 10000); // 10ç§’
        }
        
        // è‡ªåŠ¨ç”Ÿæˆå¤šæ¡ç¥ç¦è¯­å¹¶æ•£å¸ƒåœ¨å±å¹•ä¸Š
        async function generateMultipleMessages() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const messagesContainer = document.getElementById('messagesContainer');
            
            // æ˜¾ç¤ºåŠ è½½æç¤º
            loadingIndicator.classList.add('show');
            
            // ç”Ÿæˆ5æ¡ç¥ç¦è¯­
            const messageCount = 5;
            const messages = [];
            
            // å¹¶å‘ç”Ÿæˆå¤šæ¡æ¶ˆæ¯ï¼Œä¼ é€’indexç¡®ä¿æ¯æ¡æ¶ˆæ¯éƒ½ä¸åŒ
            const promises = [];
            for (let i = 0; i < messageCount; i++) {
                promises.push(generateSingleMessage(i));
            }
            
            try {
                messages.push(...await Promise.all(promises));
            } catch (error) {
                console.error('æ‰¹é‡ç”Ÿæˆå¤±è´¥:', error);
                // ä½¿ç”¨å¤‡ç”¨ç¥ç¦è¯­ï¼ˆä¸€å¥è¯ï¼‰
                const fallbackMessages = [
                    'åœ¨è¿™ä¸ªæ¸©é¦¨çš„åœ£è¯å¤œï¼Œæ„¿æˆ‘ä»¬çš„çˆ±æƒ…å¦‚é›ªèŠ±èˆ¬çº¯æ´ï¼Œå¦‚æ˜Ÿå…‰èˆ¬é—ªè€€ï¼Œæ°¸è¿œç›¸ä¼´ï¼Œåœ£è¯å¿«ä¹ï¼',
                    'åœ£è¯çš„é’Ÿå£°å“èµ·ï¼Œæ„¿æˆ‘ä»¬çš„çˆ±æƒ…å¦‚åœ£è¯æ ‘ä¸Šçš„å½©ç¯ï¼Œæ°¸è¿œé—ªé—ªå‘å…‰ï¼Œæ¸©æš–å½¼æ­¤çš„å¿ƒæˆ¿ã€‚',
                    'é›ªèŠ±é£˜è½çš„å­£èŠ‚ï¼Œæˆ‘æƒ³å¯¹ä½ è¯´ï¼šæœ‰ä½ é™ªä¼´çš„æ¯ä¸€å¤©ï¼Œéƒ½æ˜¯æˆ‘æœ€çè´µçš„åœ£è¯ç¤¼ç‰©ã€‚',
                    'æ„¿è¿™ä¸ªåœ£è¯ï¼Œæˆ‘ä»¬çš„çˆ±æƒ…å¦‚é›ªèŠ±èˆ¬çº¯å‡€ï¼Œå¦‚æ˜Ÿå…‰èˆ¬ç’€ç’¨ï¼Œæ°¸è¿œç›¸å®ˆï¼Œæ°¸ä¸åˆ†ç¦»ã€‚',
                    'åœ£è¯çš„å¤œæ™šï¼Œæœ‰ä½ åœ¨èº«è¾¹ï¼Œå°±æ˜¯æˆ‘æœ€æƒ³è¦çš„ç¤¼ç‰©ã€‚æ„¿æˆ‘ä»¬çš„çˆ±æƒ…æ°¸è¿œå¦‚åˆï¼Œåœ£è¯å¿«ä¹ï¼'
                ];
                messages.push(...fallbackMessages.slice(0, messageCount));
            }
            
            // éšè—åŠ è½½æç¤º
            loadingIndicator.classList.remove('show');
            
            // ä¾æ¬¡åˆ›å»ºæ•£å¸ƒçš„è¯è¯­å…ƒç´ 
            messages.forEach((message, index) => {
                setTimeout(() => {
                    createFloatingMessage(message, index, messages.length);
                }, index * 200); // æ¯200msåˆ›å»ºä¸€ä¸ªï¼Œå½¢æˆä¾æ¬¡å‡ºç°çš„æ•ˆæœ
            });
        }
        
        // æ’­æ”¾èƒŒæ™¯éŸ³ä¹
        function playBackgroundMusic() {
            const music = document.getElementById('backgroundMusic');
            if (music) {
                // å°è¯•æ’­æ”¾éŸ³ä¹
                const playPromise = music.play();
                
                // å¦‚æœæ’­æ”¾å¤±è´¥ï¼ˆç”±äºæµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥ï¼‰ï¼Œå°è¯•åœ¨ç”¨æˆ·äº¤äº’åæ’­æ”¾
                if (playPromise !== undefined) {
                    playPromise.catch(error => {
                        console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œç­‰å¾…ç”¨æˆ·äº¤äº’...');
                        // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç”¨æˆ·ç‚¹å‡»é¡µé¢åæ’­æ”¾
                        const playOnInteraction = () => {
                            music.play().catch(err => {
                                console.log('éŸ³ä¹æ’­æ”¾å¤±è´¥:', err);
                            });
                            // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼Œåªæ’­æ”¾ä¸€æ¬¡
                            document.removeEventListener('click', playOnInteraction);
                            document.removeEventListener('touchstart', playOnInteraction);
                        };
                        document.addEventListener('click', playOnInteraction);
                        document.addEventListener('touchstart', playOnInteraction);
                    });
                }
            }
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            createSnowflakes();
            
            // æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            playBackgroundMusic();
            
            // é¡µé¢åŠ è½½æ—¶ä» GitHub åŠ è½½å›å¿†æ•°æ®ï¼ˆå¦‚æœé…ç½®äº† tokenï¼‰
            await loadMemoriesFromGitHub();
            
            // é¡µé¢åŠ è½½æ—¶ç«‹å³å¼€å§‹ç”Ÿæˆç¥ç¦è¯­
            generateMultipleMessages();
            
            // ç›‘å¬è§†é¢‘æ’­æ”¾ç»“æŸ
            const video = document.getElementById('christmasVideo');
            video.addEventListener('ended', function() {
                // å»¶è¿Ÿ1ç§’åæ˜¾ç¤ºæ–°é¡µé¢ï¼Œå¢åŠ è¿‡æ¸¡æ•ˆæœ
                setTimeout(showCouplePage, 1000);
            });
            
            // å¦‚æœè§†é¢‘åŠ è½½å¤±è´¥æˆ–æ— æ³•æ’­æ”¾ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ˜¾ç¤ºé¡µé¢ï¼ˆç”¨äºæµ‹è¯•ï¼‰
            // showCouplePage(); // å–æ¶ˆæ³¨é‡Šæ­¤è¡Œå¯ä»¥è·³è¿‡è§†é¢‘ç›´æ¥æµ‹è¯•é¡µé¢
        });
    </script>
</body>
</html>